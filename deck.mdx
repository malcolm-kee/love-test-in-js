export { book as theme } from 'mdx-deck/themes';

import { Appear, Head, Image } from 'mdx-deck';
import { Invert } from 'mdx-deck/layouts';
import CodeSurfer from './components/code-surfer';
import Scripts from './components/scripts';

<Head>
  <title>How to Love Writing JavaScript Tests</title>
</Head>

export default Invert;

# How to Love Writing JavaScript Tests

maybe for other language too? ü§∑

---

<CodeSurfer
  code={require('!!raw-loader!./snippets/1.js')}
  steps={[
    { notes: 'How test looks like' },
    { range: [1, 14], notes: 'Code to be tested' },
    { range: [17, 30], notes: 'The test' }
  ]}
/>

---

# I hated writing JavaScript tests

---

## 1. Hard to maintain (add code + bug fix)

---

## 2. Doesn't catch my bug

---

## 3. Boring

---

## 4. "If I'm a good developer, my code shouldn't have bug."

---

export default Invert;

## Is the value of automated testing a myth?

---

<blockquote className="twitter-tweet">
  <p lang="en" dir="ltr">
    Write tests. Not too many. Mostly integration.
  </p>
  &mdash; Guillermo ‚ñ≤ (@rauchg) <a href="https://twitter.com/rauchg/status/807626710350839808?ref_src=twsrc%5Etfw">December 10, 2016</a>
</blockquote>

---

# Rule #1: Test it at "Right" Level of Isolation

---

<Image src="images/testing_pyramid.png" />

---

<CodeSurfer
  code={require('!!raw-loader!./snippets/unit-test-2.js')}
  showNumbers
  steps={[
    { notes: 'An example of unit test' },
    { range: [1, 18], notes: 'Code to be tested' },
    { range: [20, 58], notes: 'The test' },
    {
      range: [21, 40],
      notes:
        'Mocking jquery so we only test getPokemonData and nothing else'
    },
    {
      range: [42, 58],
      notes: 'Making assertion about getPokemonData'
    }
  ]}
/>

---

<Image src="images/testing_pyramid_with_tradeoff.png" />

---

## The higher level the test is, the more likely it will catch the bug that our limited mental power could not expect.

---

## The higher level the test is, the more it resembles how our code is being used, the more confidence we could gain from it.

---

<Image src="images/man_push_up.gif" />

---

## Test is like security. Too much of it will cause the "safest" result: do nothing.

## So...

---

## Test public API...

---

<blockquote className="twitter-tweet">
  <p lang="en" dir="ltr">
    The common wisdom is that unit tests make refactoring harder, but
    for React, the opposite has been true. I do huge rewrites several
    times a year, and I‚Äôm only able to do so because our test suite
    provides so much safety.
    <br />
    <br />
    When people say, ‚Äúonly test the public API,‚Äù this is why!
  </p>
  &mdash; Andrew Clark (@acdlite)
  <a href="https://twitter.com/acdlite/status/1105318434085040128?ref_src=twsrc%5Etfw">
    March 12, 2019
  </a>
</blockquote>

---

## and private API that you feel less confident.

---

# Rule #2: Test code is code too

---

## keep it DRY (but don't overdo it)

---

<CodeSurfer
  code={require('!!raw-loader!./snippets/repetition-in-test.js')}
  steps={[
    { notes: 'An example of test' },
    { range: [1, 3], notes: 'Import helpers and code to be tested' },
    { range: [5, 19], notes: 'Test that verify positive scenario' },
    {
      range: [21, 35],
      notes: 'Test that verify validation'
    }
  ]}
/>

---

<CodeSurfer
  code={require('!!raw-loader!./snippets/dry-in-test.js')}
  showNumbers
  steps={[
    { notes: 'How to make your test DRY' },
    {
      range: [5, 22],
      notes: 'Create a setup method and returns meaningful functions'
    },
    { range: [25, 33], notes: 'Use the setup method in your test' },
    {
      range: [35, 49],
      notes: 'Another test'
    }
  ]}
/>

---

## it's all tradeoff

---

# How to Get Started

---

## [`@testing-library`](https://testing-library.com/)

- `@testing-library/angular`
- `@testing-library/cypress`
- `@testing-library/react`
- `@testing-library/svelte`
- `@testing-library/vue`

---

export default Invert;

# Give It a Try

<Appear>
  <h2>Questions?</h2>
</Appear>

<Scripts scriptSrc="https://platform.twitter.com/widgets.js" />
